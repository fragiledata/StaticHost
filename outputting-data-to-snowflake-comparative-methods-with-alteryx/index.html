<!DOCTYPE html><html lang="en-gb"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Outputting Data to Snowflake; Comparative Methods with Alteryx - fragiledata.co.uk</title><meta name="description" content="My firm have recently signed up with Snowflake, so on a spare&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://fragiledata.github.io/StaticHost/outputting-data-to-snowflake-comparative-methods-with-alteryx/"><link rel="alternate" type="application/atom+xml" href="https://fragiledata.github.io/StaticHost/feed.xml"><link rel="alternate" type="application/json" href="https://fragiledata.github.io/StaticHost/feed.json"><meta property="og:title" content="Outputting Data to Snowflake; Comparative Methods with Alteryx"><meta property="og:image" content="https://fragiledata.github.io/StaticHost/media/posts/40/image-6.png"><meta property="og:site_name" content="fragiledata.co.uk"><meta property="og:description" content="My firm have recently signed up with Snowflake, so on a spare&hellip;"><meta property="og:url" content="https://fragiledata.github.io/StaticHost/outputting-data-to-snowflake-comparative-methods-with-alteryx/"><meta property="og:type" content="article"><link rel="stylesheet" href="https://fragiledata.github.io/StaticHost/assets/css/style.css?v=a6950391b9d7a19ed4119a1415d4ddee"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://fragiledata.github.io/StaticHost/outputting-data-to-snowflake-comparative-methods-with-alteryx/"},"headline":"Outputting Data to Snowflake; Comparative Methods with Alteryx","datePublished":"2021-04-27T09:58","dateModified":"2022-05-25T19:42","image":{"@type":"ImageObject","url":"https://fragiledata.github.io/StaticHost/media/posts/40/image-6.png","height":489,"width":970},"description":"My firm have recently signed up with Snowflake, so on a spare&hellip;","author":{"@type":"Person","name":"fragiledata","url":"https://fragiledata.github.io/StaticHost/authors/fragiledata/"},"publisher":{"@type":"Organization","name":"fragiledata"}}</script></head><body><div class="container"><header class="header" id="js-header"><a href="https://fragiledata.github.io/StaticHost/" class="logo">fragiledata.co.uk</a></header><main><article class="post wrapper"><header class="hero"><p class="post__meta">By <a href="https://fragiledata.github.io/StaticHost/authors/fragiledata/" rel="author" title="fragiledata">fragiledata</a> Published on <time datetime="2021-04-27T09:58">Tuesday, 27 April 2021</time></p><h1 class="post__title">Outputting Data to Snowflake; Comparative Methods with Alteryx</h1></header><figure class="post__featured-image post__image--wide"><img src="https://fragiledata.github.io/StaticHost/media/posts/40/image-6.png" srcset="https://fragiledata.github.io/StaticHost/media/posts/40/responsive/image-6-xs.png 300w, https://fragiledata.github.io/StaticHost/media/posts/40/responsive/image-6-sm.png 480w, https://fragiledata.github.io/StaticHost/media/posts/40/responsive/image-6-md.png 768w, https://fragiledata.github.io/StaticHost/media/posts/40/responsive/image-6-lg.png 1024w, https://fragiledata.github.io/StaticHost/media/posts/40/responsive/image-6-xl.png 1360w, https://fragiledata.github.io/StaticHost/media/posts/40/responsive/image-6-2xl.png 1600w, https://fragiledata.github.io/StaticHost/media/posts/40/responsive/image-6-sm2.png 375w" sizes="(max-width: 1600px) 100vw, 1600px" loading="eager" height="489" width="970" alt="A simple Alteryx workflow showing four different connections to SnowFlake databases."><figcaption>A simple Alteryx workflow showing four different connections to SnowFlake databases.</figcaption></figure><div class="post__entry"><p></p><p>My firm have recently signed up with Snowflake, so on a spare afternoon I decided to compare the different ways you can connect data to Snowflake from Alteryx. I'm doing this with some Kickstarter data I found on <a href="https://data.world/rdowns26/kickstarter-campaigns">data.world</a>; I'm breaking the data down into four tables, and writing each table with a different method.</p><p></p><p></p><figure class="wp-block-image size-large"><figure class="wp-image-621"><img loading="lazy" src="https://fragiledata.github.io/StaticHost/media/posts/40/image-6.png" sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://fragiledata.github.io/StaticHost/media/posts/40/responsive/image-6-xs.png 300w, https://fragiledata.github.io/StaticHost/media/posts/40/responsive/image-6-sm.png 480w, https://fragiledata.github.io/StaticHost/media/posts/40/responsive/image-6-md.png 768w, https://fragiledata.github.io/StaticHost/media/posts/40/responsive/image-6-lg.png 1024w" alt="An Alteryx workflow showing four different methods of Snowflake output."></figure><figcaption>An Alteryx workflow showing four different methods of Snowflake output.</figcaption></figure><p></p><p></p><h3>The ODBC connector using a regular output tool</h3><p></p><p></p><p><em>(note: both Snowflake and Alteryx do not recommend this for large data operations)</em></p><p></p><p></p><p>Using Alteryx's regular output tool, I've connected with a standard ODBC connection for Snowflake to ingest my "summary information" table, which is a load of rows with summary Kickstarter project information on. I had set up the connection as a DSN on my computer during the internal training we had, so I just reused that.</p><p></p><p></p><p>Pro: didn't really have to think much about setting it up after the first time.</p><p></p><p></p><p>Con: the ODBC driver writes one record at a time, so twenty thousand records and 11 fields took twenty minutes. It is not a fast way of doing things; I'm uploading a lot of rows from a flat file perspective, but dust from a Big Data perspective, and this took a while. There must be a better way....</p><p></p><p></p><h3>The ODBC Bulk Loader, using a regular output tool</h3><p></p><p></p><p>Other members of my firm encountered this problem early on and shortly discovered the bulk loader connection. As the name suggests, this is meant to be faster than the regular ODBC connection and is designed for bulk inputs, like I'm doing here. The original ODBC input works one line at a time, but the bulk loader stages it before contacting the database.</p><p></p><p></p><p>When I selected the bulk loader and brought up the below interface, I thought it was important to remember two things - you can select "local" for staging if you don't have an AWS bucket lying about, and you can still use Pre and Post SQL statements in the output tool.</p><p></p><p></p><div class="wp-block-image"><figure class="aligncenter size-large"><figure class="wp-image-607"><img loading="lazy" src="https://fragiledata.github.io/StaticHost/media/posts/40/image-2.png" sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://fragiledata.github.io/StaticHost/media/posts/40/responsive/image-2-xs.png 300w, https://fragiledata.github.io/StaticHost/media/posts/40/responsive/image-2-sm.png 480w, https://fragiledata.github.io/StaticHost/media/posts/40/responsive/image-2-md.png 768w, https://fragiledata.github.io/StaticHost/media/posts/40/responsive/image-2-lg.png 1024w" alt="An image showing the Snowflake Bulk Loader interface, asking the user to select a way of staging the data."></figure><figcaption>An image showing the Snowflake Bulk Loader interface, asking the user to select a way of staging the data.</figcaption></figure></div><p></p><p></p><p>Pro: Yes, definitely faster. This was the same number of rows (but only 5 columns) and took 5.1 seconds.</p><p></p><p></p><p>Con: remembering that it is there in the first place.</p><p></p><p></p><p>This is actually the second resort of Snowflake and Alteryx's recommendations. The first is our quiet and weird cousin, the In-DB tools.</p><p></p><p></p><h3>Stream and Write with the In-DB tools</h3><p></p><p></p><p>Alteryx + Snowflake's <a href="https://www.alteryx.com/whitepaper/best-practices-for-using-alteryx-with-snowflake">documentation for working together</a> recommends getting to the InDB tools as fast/as much as possible. This effectively shifts the "thought" of the process onto the DB and therefore onto Snowflake's warehouse, which makes sense in an enterprise environment. But I'm just loading in data? How does it help me?</p><p></p><p></p><p>When configuring the InDB tools to stream the data out and write it to the database, the first thing I have to configure relates to the right InDB connections - and the write string defaults to the bulk loader, so you don't have to think about picking the right one. It also makes the option to change the data chunk size much clearer as well.</p><p></p><p></p><div class="wp-block-image"><figure class="aligncenter size-large"><figure class="wp-image-610"><img loading="lazy" src="https://fragiledata.github.io/StaticHost/media/posts/40/image-3.png" sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://fragiledata.github.io/StaticHost/media/posts/40/responsive/image-3-xs.png 300w, https://fragiledata.github.io/StaticHost/media/posts/40/responsive/image-3-sm.png 480w, https://fragiledata.github.io/StaticHost/media/posts/40/responsive/image-3-md.png 768w, https://fragiledata.github.io/StaticHost/media/posts/40/responsive/image-3-lg.png 1024w" alt="A screenshot of an Alteryx configuration window, showing the bulk load chunk size is at 128mb."></figure><figcaption>A screenshot of an Alteryx configuration window, showing the bulk load chunk size is at 128mb.</figcaption></figure></div><p></p><p></p><p>Pro: Super speedy to write - this took about 6 seconds, which was creating a temp table and then creating the real table.</p><p></p><p></p><p>Con: I tend to configure my computer DSNs with only the mandatory parameters (e.g. no database or schema) and then configure them in the tools I use at the time. The InDB tools were not a massive fan of this method and means I changed the configuration of my DSNs a few times to ensure it wrote the table to the right place.</p><p></p><p></p><h3>Output with excel, and then upload</h3><p></p><p></p><p>Of course, the last of all last resorts. Sometimes you have to do things the manual way, so let's see how it goes. I have a table of web assets for the Kickstarter projects which also need to be uploaded to Snowflake. Snowflakes manual file upload service can take standard flat files (csv, json and the like), but nothing as jazzy as an excel file.</p><p></p><p></p><div class="wp-block-image"><figure class="aligncenter size-large"><figure class="wp-image-613"><img loading="lazy" src="https://fragiledata.github.io/StaticHost/media/posts/40/image-4.png" sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://fragiledata.github.io/StaticHost/media/posts/40/responsive/image-4-xs.png 300w, https://fragiledata.github.io/StaticHost/media/posts/40/responsive/image-4-sm.png 480w, https://fragiledata.github.io/StaticHost/media/posts/40/responsive/image-4-md.png 768w, https://fragiledata.github.io/StaticHost/media/posts/40/responsive/image-4-lg.png 1024w" alt="An image of Snowflake's manual data loading pane, where the load options give the user a choice as to what to do if there is an error parsing the file."></figure><figcaption>Aha, this is interesting.</figcaption></figure></div><p></p><p></p><p>My last component of the data is some supplementary information which was encoded in a JSON format in the data. Unaltered, this comes to about 174mb as a csv file (which is too large for Snowflake), so reformatted the data into a simple structure (loading JSONs will be for another time!). To load the data, you must create the table first, and then the "load data" option will become available on the Tables tool bar. Specify a schema and what it should do in the face of errors, and that's it.</p><p></p><p></p><p>Only in my case, that wasn't it. There was a lot of trial and error going on on my part to understand the limitations of flat file upload, such that I've concluded the best configurations for me were a pipe delimited file with UTF-8 encoding. I also couldn't find the file size limits within Snowflake's documentation very easily, such that my knowledge on this is "more than 5mb but less than 174mb", which isn't particularly fine tuned. In a way though, I think it's good that uploading data as a flat file isn't <em>too </em>easy, because ideally we shouldn't just be throwing tables at the database and seeing what sticks.</p><p></p><p></p><p>Pros: straight forward process</p><p></p><p></p><p>Cons: actually quite fiddly in some of the parameters.</p><p></p><p></p><p>To conclude, the best method for posting data to Snowflake is the bulk loader, whether using InDB or regular output tools. Use other methods at your peril!</p><p></p></div><footer class="post__footer"><div class="post__last-updated">This article was updated on Wednesday, 25 May 2022</div><div class="post__footer__col"><ul class="post__tag"><li><a href="https://fragiledata.github.io/StaticHost/tags/data-engineering/">Data Engineering</a></li><li><a href="https://fragiledata.github.io/StaticHost/tags/tools-and-tech/">Tools and Tech</a></li></ul><div class="post__share"></div></div><nav class="post__nav"><div class="post__nav__prev">Previous Post<h5><a href="https://fragiledata.github.io/StaticHost/the-manners-of-webscraping-the-short-version-for-busy-analysts/" class="inverse" rel="prev">The Manners of Webscraping - The Short Version for Busy Analysts</a></h5></div></nav></footer></article></main><footer class="footer"><div class="footer__copyright">Powered by Publii</div><div class="footer__social"><a href="www.twitter.com/fragiledata" class="twitter" aria-label="Twitter"><svg class="icon"><use xlink:href="https://fragiledata.github.io/StaticHost/assets/svg/svg-map.svg#twitter"/></svg></a></div></footer></div><script defer="defer" src="https://fragiledata.github.io/StaticHost/assets/js/scripts.min.js?v=b1f07db09e44ca999e985e714f8eba4e"></script><script>window.publiiThemeMenuConfig={mobileMenuMode:'sidebar',animationSpeed:300,submenuWidth: 'auto',doubleClickTime:500,mobileMenuExpandableSubmenus:true,relatedContainerForOverlayMenuSelector:'.navbar'};</script><script>/*<![CDATA[*/var images=document.querySelectorAll("img[loading]");for(var i=0;i<images.length;i++){if(images[i].complete){images[i].classList.add("is-loaded")}else{images[i].addEventListener("load",function(){this.classList.add("is-loaded")},false)}};/*]]>*/</script></body></html>